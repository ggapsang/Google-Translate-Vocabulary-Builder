---
tags:
  - 구글크롬
  - 확장프로그램
  - 기획안
  - 단어장
---
##  데이터 저장 전략

---
### Chrome Local Storage (메인 저장소)

**용량**: 5MB  
**예상 저장 가능 단어 수**: 약 2,500개

**용량 계산 근거**:
- 단어당 평균 크기: 2KB
- 5MB = 5,120KB
- 5,120KB ÷ 2KB = 약 2,560개 단어

**충분성 분석**:
- 일반 학습자: 1,000~2,000 단어
- 고급 학습자: 3,000~5,000 단어
- 전문가급: 10,000+ 단어
- **결론**: 대부분의 사용자에게 충분

### Chrome Sync Storage (설정 저장소)

**용량**: 100KB  
**용도**: 사용자 설정 및 환경 설정만 저장

**저장 내용**:
- UI 테마 설정
- 언어 설정
- 학습 목표 (일일 단어 수)
- 알림 설정
- 테스트 난이도 설정

---

## 데이터 구조

### 단어 객체 스키마 예시

```javascript
{
  // 기본 정보
  id: "1707289800000-invoke",  // timestamp-word
  word: "invoke",
  
  // 사전 정보
  definitions: [
    {
      pos: "동사",  // 품사 (part of speech)
      meanings: [
        {
          korean: "포함하다",
          english: "(of a situation or event) include (something) as a necessary part or result",
          synonyms: ["require", "necessitate", "demand", "call for"],
          example: "his transfer to another school would involve a lengthy assessment procedure"
        },
        {
          korean: "감다",
          english: "furl, wind, roll, involve, wreathe, wring",
          synonyms: ["furl", "wind", "roll"],
          example: ""
        }
      ]
    }
  ],
  
  // 학습 컨텍스트
  context: {
    sourceText: "Of course, most indoor spaces will also fail to provide sufficient visibility of the sky for a GPS receiver to function. For these reasons, the GPS has been a popular sensor in mobile robotics, but has been relegated to projects involving mobile robot traversal of wide-open spaces and autonomous flying machines",
    translatedText: "물론 대부분의 실내 공간에서는 GPS 수신기가 제대로 작동할 만큼 충분히 보이지 않습니다. 이러한 이유로 GPS는 모바일 로봇에서 인기 있는 센서였지만, 하늘을 비행체 관련 프로젝트에만 사용되고 있습니다.",
    sourceLanguage: "en",
    targetLanguage: "ko"
  },
  
  // 메타데이터
  metadata: {
    savedAt: "2026-02-07T10:30:00Z",
    url: "https://translate.google.com/?sl=en&tl=ko&text=...",
    
    // 학습 추적
    reviewCount: 0,           // 복습 횟수
    lastReviewed: null,       // 마지막 복습 시간
    nextReview: null,         // 다음 복습 예정일 (Spaced Repetition)
    masteryLevel: 0,          // 0-5 (학습 단계)
    
    // 테스트 기록
    testResults: [
      {
        date: "2026-02-08T09:00:00Z",
        correct: true,
        testType: "multiple-choice"
      }
    ]
  },
  
  // 사용자 메모 (옵션)
  userNote: ""
}
```

### Storage Key 구조

```javascript
// Local Storage
{
  "vocabulary_words": [
    { id: "...", word: "...", ... },
    { id: "...", word: "...", ... }
  ],
  "vocabulary_meta": {
    totalWords: 150,
    lastBackup: "2026-02-07T10:30:00Z",
    version: "1.0.0"
  }
}

// Sync Storage
{
  "settings": {
    theme: "light",
    dailyGoal: 10,
    notificationsEnabled: true,
    defaultLanguagePair: "en-ko"
  }
}
```

---

## 기술 스택

### 크롬 확장 프로그램 구조

```
google-translate-vocabulary/
├── manifest.json           # 확장 프로그램 설정
├── background/
│   └── service-worker.js   # 백그라운드 서비스 워커
├── content/
│   ├── content-script.js   # 구글 번역 페이지 DOM 조작
│   └── styles.css          # 주입 스타일
├── sidepanel/
│   ├── index.html
│   ├── app.js
│   └── styles.css
├── popup/
│   ├── index.html
│   ├── app.js
│   └── styles.css
├── lib/
│   ├── storage.js          # Storage API 래퍼
│   ├── parser.js           # DOM 파싱 로직
│   ├── export.js           # CSV/Sheets Export
│   └── spaced-repetition.js # 복습 알고리즘
└── assets/
    └── icons/              # 확장 프로그램 아이콘
```

### 주요 라이브러리 (예정)

**필수**:
- Chrome Extensions API (내장)
- vanilla JavaScript (프레임워크 없이)

**옵션** (필요시):
- PapaParse: CSV 파싱/생성
- Google APIs Client Library: Sheets 연동
- Chart.js: 통계 차트

---

## Chrome Extensions API 사용

### Manifest V3 설정

```json
{
  "manifest_version": 3,
  "name": "Google Translate Vocabulary Builder",
  "version": "1.0.0",
  "permissions": [
    "storage",
    "activeTab",
    "sidePanel"
  ],
  "host_permissions": [
    "https://translate.google.com/*"
  ],
  "content_scripts": [
    {
      "matches": ["https://translate.google.com/*"],
      "js": ["content/content-script.js"],
      "css": ["content/styles.css"]
    }
  ],
  "background": {
    "service_worker": "background/service-worker.js"
  },
  "side_panel": {
    "default_path": "sidepanel/index.html"
  },
  "action": {
    "default_popup": "popup/index.html"
  }
}
```

### API 사용 계획

1. **chrome.storage.local**: 단어 데이터 저장
2. **chrome.storage.sync**: 설정 동기화
3. **chrome.sidePanel**: 메인 단어장 UI
4. **chrome.action**: 퀵 액세스 팝업
5. **chrome.alarms**: 복습 알림 (Phase 3)
6. **chrome.identity**: Google OAuth (Sheets 연동)

---

## DOM 파싱 전략

### 구글 번역 페이지 구조 분석

**목표 데이터 위치**:
1. **단어**: 사전 패널 헤더
2. **품사**: 사전 패널 내 섹션 제목
3. **한국어 뜻**: 각 의미 항목
4. **영문 정의**: 회색 설명 텍스트
5. **유의어**: 동의어 칩들
6. **원문**: 왼쪽 입력 영역
7. **번역문**: 오른쪽 출력 영역

**파싱 전략**:
- CSS Selector 기반 추출
- MutationObserver로 동적 변화 감지
- 에러 핸들링 (요소 없을 경우 graceful degradation)

---

## Export 기능

### CSV Export

**구현 방법**:
```javascript
// 데이터 → CSV 문자열 변환
const csv = convertToCSV(words);
// Blob 생성
const blob = new Blob([csv], { type: 'text/csv' });
// 다운로드 트리거
const url = URL.createObjectURL(blob);
chrome.downloads.download({ url, filename: 'vocabulary.csv' });
```

**CSV 포맷**:
```csv
단어,품사,한국어 뜻,영어 정의,유의어,예문(원문),예문(번역),저장일시,복습횟수
invoke,동사,포함하다,"(of a situation or event) include...","require, necessitate","Of course, most...","물론 대부분...",2026-02-07,0
```

### Google Sheets Export

**Phase 1**: CSV 다운로드 → 사용자 수동 업로드

**Phase 2**: Google Sheets API 연동

```javascript
// OAuth 인증
chrome.identity.getAuthToken({ interactive: true }, (token) => {
  // Sheets API 호출
  createSpreadsheet(token, vocabularyData);
});
```

**생성 시트 구조**:

- Sheet 1: 단어장 (모든 단어)
- Sheet 2: 통계 (자동 집계)
- Sheet 3: 복습 필요 (오늘 복습할 단어)

---

## 보안 & 프라이버시

### 데이터 보호
- 모든 데이터는 사용자 로컬에 저장
- 외부 서버 전송 없음 (Sheets Export는 사용자 선택)
- Chrome Sync도 사용자 구글 계정에만 저장

### 권한 최소화

- 필요한 권한만 요청
- translate.google.com에만 접근
- 사용자 명시적 동의 후 Sheets 접근

---

## 성능 최적화

### 저장소 최적화
- JSON 압축 (Phase 3)
- 인덱싱 (단어 → ID 매핑)
- 지연 로딩 (페이지네이션)

### UI 최적화
- Virtual Scrolling (단어 목록)
- Debounce (검색 입력)
- Web Workers (대량 데이터 처리)

---

## 테스트 전략

### 단위 테스트
- Storage 로직
- Parser 로직
- Export 로직

### 통합 테스트
- Chrome Extension 환경 테스트
- 구글 번역 페이지 DOM 변화 대응

### 사용자 테스트
- 베타 테스터 모집 (Phase 1 완료 후)
- 피드백 수집 및 반영

---

**관련 문서**:
- [[01 프로젝트 기획안]]
- [[03 UIUX 설계]]
- [[05 데이터 구조]]
